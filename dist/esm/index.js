import u,{useCallback as Ft,useState as wt,useRef as Pn,useMemo as Nn}from"react";import{createEditor as In}from"slate";import{Slate as Sn,Editable as Bn,withReact as Fn,ReactEditor as wn}from"slate-react";import ke from"react";var Te=e=>ke.createElement("pre",{...e.attributes},ke.createElement("code",null,e.children));import Mt from"react";var He=e=>Mt.createElement("p",{...e.attributes},e.children);import At from"react";var Pe=e=>At.createElement("blockquote",{...e.attributes},e.children);import qt from"react";var Ne=e=>qt.createElement("h1",{...e.attributes},e.children);import $t from"react";var Ie=e=>$t.createElement("h2",{...e.attributes},e.children);import Ot from"react";var Se=e=>Ot.createElement("h3",{...e.attributes},e.children);import Vt from"react";var Be=e=>Vt.createElement("h4",{...e.attributes},e.children);import Dt from"react";var Fe=e=>Dt.createElement("h5",{...e.attributes},e.children);import Kt from"react";var we=e=>Kt.createElement("h6",{...e.attributes},e.children);import zt from"react";var Le=e=>zt.createElement("ol",{...e.attributes},e.children);import Gt from"react";var Ue=e=>Gt.createElement("ul",{...e.attributes},e.children);import Rt from"react";var Me=e=>Rt.createElement("li",{...e.attributes},e.children);import{Editor as E,Node as z,Point as Wt,Transforms as g,Text as Zt}from"slate";var Ae=(e,t,o)=>{g.setNodes(e,{...o,type:t})},jt=e=>{let t=se(e);t&&g.unwrapNodes(e,{at:t})},se=e=>e.selection?e.selection.anchor.path.slice(0,-1):null,qe=e=>{let t=e.selection?.anchor.path;return t?(t=t.slice(0,-1),z.get(e,t)):null},Qt=e=>{if(!e.selection)return null;let t=qe(e);return t?t.type:null},Yt=(e,t)=>{let o=e.selection?.anchor.path;if(!o)return null;do{let r=z.get(e,o);if(!r)return null;if(r.type===t)return r;o=o?.slice(0,-1)}while(o.length>0);return null},$e=e=>{g.splitNodes(e,{always:!0})},Jt=(e,t,o={})=>{if(g.insertNodes(e,{...o.props,type:t,children:o.children||[{text:""}]},{voids:o.voids}),o.createFollowingParagraph&&g.insertNodes(e,{type:"paragraph",children:[{text:""}]}),o.createFollowingText!==void 0){if(!e.selection)return;let r=E.parent(e,e.selection)[1];r[r.length-1]++,g.insertNodes(e,{text:o.createFollowingText},{at:r}),g.select(e,{anchor:{path:r,offset:o.createFollowingText.length},focus:{path:r,offset:o.createFollowingText.length}})}},Xt=(e,t,o={})=>{g.wrapNodes(e,{type:t,...o},{split:!0})},eo=e=>{g.liftNodes(e)},to=e=>{g.unwrapNodes(e)},ie=e=>e.selection?Wt.equals(e.selection.anchor,e.selection.focus):!1,Oe=e=>e.selection?!ie(e):!1,ae=e=>{let t=E.above(e,{match:r=>E.isBlock(e,r)}),o=t?t[1]:[];return E.start(e,o)},Ve=e=>{let t=E.above(e,{match:r=>E.isBlock(e,r)}),o=t?t[1]:[];return E.end(e,o)},De=e=>{if(!e.selection)return null;let t=ae(e),o={anchor:e.selection.anchor,focus:t};return E.string(e,o)},oo=e=>{if(!e.selection)return null;let t=Ve(e),o={anchor:e.selection.focus,focus:t};return E.string(e,o)},ro=(e,t,o)=>{if(!e.selection)return null;let r=me(e);if(!r)return null;let s=r.lastIndexOf(t);return o?.isolated&&(r.substring(s+t.length,s+t.length*2)===t||r.substring(s-t.length,s)===t)||s===-1?null:{path:e.selection.anchor.path,offset:s}},no=(e,t)=>!e.selection||!ie(e)?!1:!!De(e)?.endsWith(t),me=e=>e.selection?E.string(e,{anchor:{path:e.selection.anchor.path,offset:0},focus:e.selection.anchor}):null,Ke=(e,t)=>{if(!e.selection)return;let o=ae(e);o&&(g.delete(e,{at:{anchor:o,focus:e.selection.anchor}}),g.insertText(e,t,{at:o}))},lo=(e,t)=>{let o=me(e);o&&(o=o.slice(t),Ke(e,o))},so=(e,t)=>{for(let o=0;o<t;o++)E.deleteBackward(e,{unit:"character"})},io=(e,t,o)=>{g.delete(e,{at:t,distance:o,unit:"character"})},ze=(e,t)=>e.selection?E.above(e,{match:o=>t.includes(o.type)})!==void 0:!1,ao=(e,t)=>e.selection?ze(e,[t]):!1,Ge=e=>{if(!e.selection)return null;let t=E.above(e,{match:o=>E.isBlock(e,o)});return!t||!Ze(t[0])?null:t[0]},mo=e=>{if(!e.selection)return null;let t=se(e);return t?ue(e,t):null},ue=(e,t)=>{let o=t;if(o.length===0)return null;do{let r=z.get(e,o);if(!r)return null;if(E.isBlock(e,r))return o;o=o.slice(0,-1)}while(o.length>0);return null},uo=e=>{if(!e.selection)return null;let t=Ge(e);return t?t.type:null},Re=e=>{if(!e.selection)return null;let t=mo(e);return!t||(t=t.slice(0,-1),t=ue(e,t),!t)?null:z.get(e,t)},co=e=>{let t=Re(e);return t?t.type:null},We=e=>{if(!e.selection)return null;let t=E.node(e,e.selection.anchor);return!t||!je(t[0])?null:t[0]},Ze=e=>{let t=e;return!!(t&&t.type)},je=e=>{let t=e;return!!(t&&t.text)},po=e=>{let t=e.selection?.anchor||e.selection?.focus;return t?t.path.length<=2:!1},fo=e=>{let t=e,o=e;return!t.text&&!o.type},go=e=>{if(Oe(e)||!e.selection)return!1;let t=We(e);return t?t.text==="":!0},Co=e=>{e.selection&&($e(e),Ae(e,"paragraph"),Qe(e))},Eo=e=>{g.insertText(e,`
`)},Qe=e=>{for(;!n.isAtRoot(e);)g.liftNodes(e)},ho=(e,t,o)=>{e.selection&&g.setNodes(e,t,{at:o||e.selection,match:r=>Zt.isText(r),split:!0})},bo=(e,t,o)=>{g.setNodes(e,o,{match:r=>r.type===t})},n={removeInlineNode:jt,changeCurrentNodeType:Ae,createNewNode:Jt,createNewNodeOfCurrentType:$e,wrapNode:Xt,unwrapNode:eo,unwrapLeaf:to,isCursor:ie,isSelection:Oe,nearestBlockPath:ue,currentBlockStart:ae,currentBlockEnd:Ve,textSinceBlockStart:De,textToBlockEnd:oo,lastPosOf:ro,cursorIsBehind:no,currentBlockText:me,setCurrentBlockText:Ke,deleteFromLeft:lo,deleteFromRight:so,deleteAt:io,isChildOf:ao,isChildOfAny:ze,nearestElementOfType:Yt,currentBlock:Ge,currentBlockType:uo,currentElement:qe,currentElementType:Qt,currentElementPath:se,parentBlock:Re,parentBlockType:co,currentLeaf:We,isElement:Ze,isLeaf:je,isRoot:fo,isEmpty:go,isAtRoot:po,createRootParagraph:Co,createNewline:Eo,liftToRoot:Qe,setLeafFormat:ho,changeNearestNodeProps:bo};import de from"react";var Ye=e=>{let t=de.createElement("span",{...e.attributes},e.children);return e.leaf.bold&&(t=de.createElement("strong",null,t)),e.leaf.italic&&(t=de.createElement("em",null,t)),t};import{Editor as B}from"slate";var Je=e=>!!B.marks(e)?.bold,Xe=e=>!!B.marks(e)?.italic,et=(e,t)=>{e.selection&&n.setLeafFormat(e,{bold:!0},t)},yo=e=>{n.setLeafFormat(e,{bold:void 0})},tt=(e,t)=>{e.selection&&n.setLeafFormat(e,{italic:!0},t)},_o=e=>{n.setLeafFormat(e,{italic:void 0})},vo=e=>{Je(e)?B.removeMark(e,"bold"):B.addMark(e,"bold",!0)},xo=e=>{Xe(e)?B.removeMark(e,"italic"):B.addMark(e,"italic",!0)},ko=(e,t)=>{if(["_","*"].includes(t.key))if(n.cursorIsBehind(e,t.key)){let o=n.lastPosOf(e,`${t.key}${t.key}`);if(!o||!e.selection)return;et(e,{anchor:o,focus:e.selection.anchor}),B.addMark(e,"bold",!1),n.deleteAt(e,o,2),n.deleteFromRight(e,1),n.deleteAt(e,e.selection.anchor,1),t.preventDefault()}else{let o=n.lastPosOf(e,t.key,{isolated:!0});if(!o||!e.selection)return;tt(e,{anchor:o,focus:e.selection.anchor}),B.addMark(e,"italic",!1),n.deleteAt(e,o,1),t.preventDefault()}},L={isBoldActive:Je,isItalicActive:Xe,toggleBold:vo,toggleItalic:xo,setBold:et,setItalic:tt,unsetBold:yo,unsetItalic:_o,handleBoldAndItalic:ko};import h,{useContext as gn}from"react";var ce={container:"Toolbar-module__container_rf3kvG__020",innerContainer:"Toolbar-module__innerContainer_rf3kvG__020"};import N,{useMemo as Ho,useContext as Po}from"react";var ot={button:"ToolbarButton-module__button_U5m4DG__020"};import{FaBold as No,FaItalic as Io,FaListOl as So,FaList as Bo,FaQuoteLeft as Fo,FaCode as wo,FaUpload as Lo,FaLink as Uo,FaImage as Mo}from"react-icons/fa";import{createContext as To}from"react";var a=To(void 0);var v=e=>{let t=Po(a),o=Ho(()=>{switch(e.icon){case"bold":return N.createElement(No,null);case"italic":return N.createElement(Io,null);case"ordered-list":return N.createElement(So,null);case"unordered-list":return N.createElement(Bo,null);case"blockquote":return N.createElement(Fo,null);case"code":return N.createElement(wo,null);case"upload":return N.createElement(Lo,null);case"hyperlink":return N.createElement(Uo,null);case"image":return N.createElement(Mo,null)}},[e.icon]);return N.createElement("button",{onMouseDown:s=>{s.preventDefault()},className:`${ot.button} ${t?.toolbar?.buttonClassName||""} ${e.active?"active":""}`,onClick:e.onClick},o||e.text)};import{Editor as Ao}from"slate";var A=(e,t)=>{let[o]=Ao.nodes(e,{match:r=>r.type===t});return!!o},qo=(e,t)=>{A(e,t)?n.changeCurrentNodeType(e,"paragraph"):n.changeCurrentNodeType(e,t)},$o=(e,t)=>{if(!A(e,t))return n.liftToRoot(e),n.changeCurrentNodeType(e,t);n.changeCurrentNodeType(e,"paragraph")},Oo=(e,t,o,r)=>{if(A(e,t))n.removeInlineNode(e);else{let d=r&&n.isCursor(e)?{...o,children:r}:o;n.changeCurrentNodeType(e,t,d)}},Vo=(e,t)=>{let o=A(e,t),r=n.isChildOf(e,"ordered-list-item"),s=n.isChildOf(e,"unordered-list-item"),d=r||s;if(o&&d)return n.unwrapLeaf(e);if(o&&!d)return n.changeCurrentNodeType(e,"paragraph");n.changeCurrentNodeType(e,t),d&&n.wrapNode(e,r?"ordered-list-item":"unordered-list-item")},pe=(e,t)=>{t.shiftKey?n.createNewline(e):n.createRootParagraph(e),t.preventDefault()},Do=(e,t)=>{let o=n.isChildOf(e,"ordered-list-item"),r=n.isChildOf(e,"unordered-list-item"),s=o||r;if(!s||t.shiftKey)return pe(e,t);if(s)return n.createNewNodeOfCurrentType(e),n.changeCurrentNodeType(e,o?"ordered-list-item":"unordered-list-item"),t.preventDefault();pe(e,t)},rt=(e,t)=>{do n.unwrapNode(e);while(n.parentBlockType(e)===t);n.changeCurrentNodeType(e,"paragraph")},Ko=(e,t,o)=>{let r=t==="ordered-list"?"ordered-list-item":"unordered-list-item";if(A(e,r))return rt(e,t);n.isChildOf(e,t)||n.wrapNode(e,t),n.changeCurrentNodeType(e,r)},zo=(e,t,o)=>{if(o.shiftKey){n.unwrapNode(e);let r=n.parentBlock(e);(!r||r.type!==t)&&n.changeCurrentNodeType(e,"paragraph")}else{let r=n.parentBlock(e);if(!n.currentBlock(e)||!r)return;n.wrapNode(e,t)}o.preventDefault()},Go=(e,t,o)=>{n.textSinceBlockStart(e)===""&&(rt(e,t),o.preventDefault())},l={defaultIsActive:A,defaultToggle:qo,toggleInlineNode:Oo,toggleAtRoot:$o,toggleWithListAllowed:Vo,onEnterWithShiftLinebreak:pe,onEnterWithListAndNewlineAllowed:Do,toggleListItem:Ko,onTabListItem:zo,onEnterListItem:Go};var Ro=e=>l.defaultIsActive(e,"unordered-list"),Wo=e=>{l.defaultToggle(e,"unordered-list")},G={elementType:"unordered-list",isVoid:!1,isInline:!1,active:Ro,toggle:Wo};var Zo=e=>l.defaultIsActive(e,"ordered-list"),jo=e=>{l.defaultToggle(e,"ordered-list")},R={elementType:"ordered-list",isVoid:!1,isInline:!1,active:Zo,toggle:jo};var Qo=e=>l.defaultIsActive(e,"blockquote"),Yo=e=>{l.toggleWithListAllowed(e,"blockquote")},Jo=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},O={elementType:"blockquote",shortcutText:">",isVoid:!1,isInline:!1,active:Qo,toggle:Yo,onEnter:Jo};var Xo=e=>l.defaultIsActive(e,"code"),er=e=>{l.toggleWithListAllowed(e,"code")},tr=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},V={elementType:"code",shortcutText:"```",isVoid:!1,isInline:!1,active:Xo,toggle:er,onEnter:tr};var or=e=>l.defaultIsActive(e,"heading-1"),rr=e=>{l.toggleAtRoot(e,"heading-1")},nr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},W={elementType:"heading-1",shortcutText:"#",isVoid:!1,isInline:!1,active:or,toggle:rr,onEnter:nr};var lr=e=>l.defaultIsActive(e,"heading-2"),sr=e=>{l.toggleAtRoot(e,"heading-2")},ir=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Z={elementType:"heading-2",shortcutText:"##",isVoid:!1,isInline:!1,active:lr,toggle:sr,onEnter:ir};var ar=e=>l.defaultIsActive(e,"heading-3"),mr=e=>{l.toggleAtRoot(e,"heading-3")},ur=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},j={elementType:"heading-3",shortcutText:"###",isVoid:!1,isInline:!1,active:ar,toggle:mr,onEnter:ur};var dr=e=>l.defaultIsActive(e,"heading-4"),cr=e=>{l.toggleAtRoot(e,"heading-4")},pr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Q={elementType:"heading-4",shortcutText:"####",isVoid:!1,isInline:!1,active:dr,toggle:cr,onEnter:pr};var fr=e=>l.defaultIsActive(e,"heading-5"),gr=e=>{l.toggleAtRoot(e,"heading-5")},Cr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Y={elementType:"heading-5",shortcutText:"#####",isVoid:!1,isInline:!1,active:fr,toggle:gr,onEnter:Cr};var Er=e=>l.defaultIsActive(e,"heading-6"),hr=e=>{l.toggleAtRoot(e,"heading-6")},br=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},J={elementType:"heading-6",shortcutText:"######",isVoid:!1,isInline:!1,active:Er,toggle:hr,onEnter:br};var yr=e=>l.defaultIsActive(e,"unordered-list-item"),_r=(e,t)=>{l.toggleListItem(e,"unordered-list",t)},vr=(e,t)=>{l.onTabListItem(e,"unordered-list",t)},xr=(e,t)=>{l.onEnterListItem(e,"unordered-list",t)},X={elementType:"unordered-list-item",shortcutText:"*",isVoid:!1,isInline:!1,active:yr,toggle:_r,onTab:vr,onEnter:xr};var kr=e=>l.defaultIsActive(e,"paragraph"),Tr=e=>{n.changeCurrentNodeType(e,"paragraph")},Hr=(e,t)=>{l.onEnterWithShiftLinebreak(e,t)},nt={elementType:"paragraph",isVoid:!1,isInline:!1,active:kr,toggle:Tr,onEnter:Hr};var Pr=e=>l.defaultIsActive(e,"hyperlink"),Nr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],s=t.actorShortcutMatch[2];n.createNewNode(e,"hyperlink",{children:[{text:r}],props:{href:s},createFollowingText:" "})}else l.toggleInlineNode(e,"hyperlink",o,[{text:"Link"}])},Ir=(e,t)=>{if(!n.isChildOf(e,"hyperlink"))return n.isSelection(e)?n.wrapNode(e,"hyperlink",t):n.createNewNode(e,"hyperlink",{children:t.children,props:t,voids:!0,createFollowingText:" "});n.changeNearestNodeProps(e,"hyperlink",t)},H={elementType:"hyperlink",shortcutRegex:/\[(.+)]\((.+)\)$/,isVoid:!1,isInline:!0,active:Pr,toggle:Nr,onUpsert:Ir};var Sr=e=>l.defaultIsActive(e,"image"),Br=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],s=t.actorShortcutMatch[2];n.createNewNode(e,"image",{props:{src:s,altText:r},createFollowingText:" "})}else l.toggleInlineNode(e,"image",o)},Fr=(e,t)=>{let o=n.currentElement(e);o&&(o.type==="image"?n.changeNearestNodeProps(e,"image",t):n.createNewNode(e,"image",{props:t,voids:!0,createFollowingText:" "}))},F={elementType:"image",shortcutRegex:/!\[(.+)]\((.+)\)$/,isVoid:!0,isInline:!0,active:Sr,toggle:Br,onUpsert:Fr};var wr=e=>l.defaultIsActive(e,"ordered-list-item"),Lr=(e,t)=>{l.toggleListItem(e,"ordered-list",t)},Ur=(e,t)=>{l.onTabListItem(e,"ordered-list",t)},Mr=(e,t)=>{l.onEnterListItem(e,"ordered-list",t)},ee={elementType:"ordered-list-item",shortcutRegex:/^\d+\.$/,isVoid:!1,isInline:!1,active:wr,toggle:Lr,onTab:Ur,onEnter:Mr};var te=[O,V,W,Z,j,Q,Y,J,F,H,R,ee,nt,G,X],q={};te.forEach(e=>{q[e.elementType]=e});var fe=te.filter(e=>!e.isInline),Ar={};fe.forEach(e=>{Ar[e.elementType]=e});var oe=te.filter(e=>e.isInline),qr={};oe.forEach(e=>{qr[e.elementType]=e});var ge=te.filter(e=>e.isVoid),$r={};ge.forEach(e=>{$r[e.elementType]=e});import lt from"react";var Ce={container:"ToolbarButtonSpacer-module__container_kEBEkG__020",spacer:"ToolbarButtonSpacer-module__spacer_kEBEkG__020"};var D=()=>lt.createElement("div",{className:Ce.container},lt.createElement("div",{className:Ce.spacer}));import{useSlate as Cn}from"slate-react";import I,{useContext as rn,useEffect as nn,useMemo as ln,useRef as sn,useState as bt}from"react";import st,{useRef as Or,useContext as Vr}from"react";var Ee={container:"Popover-module__container_dxsL9W__020",innerContainer:"Popover-module__innerContainer_dxsL9W__020"};import{useOnClickOutside as Dr}from"usehooks-ts";var re=e=>{let t=Vr(a),o=Or(null);Dr(o,e.onClose);let r=s=>{e.onPressEnter&&s.key==="Enter"&&e.onPressEnter()};return st.createElement("div",{className:`${Ee.container} ${t?.popover?.containerClassName||""}`},st.createElement("div",{className:`${Ee.innerContainer} ${e.align} ${t?.popover?.innerContainerClassName||""}`,ref:o,onKeyDown:r},e.children))};var he={container:"HyperlinkToolbarButton-module__container_KZEcDq__020",hrefInput:"HyperlinkToolbarButton-module__hrefInput_KZEcDq__020"};import{ReactEditor as an,useSlate as mn}from"slate-react";import tn,{useContext as on}from"react";var it={container:"Form-module__container_R0Llbq__020"};import Kr,{useContext as zr}from"react";var at={container:"FormGroup-module__container_t4ESPW__020"};var ne=e=>{let t=zr(a);return Kr.createElement("div",{className:`${at.container} ${t?.forms?.groupClassName||""}`},e.children)};import Gr,{useContext as Rr}from"react";var mt={label:"FormLabel-module__label_jkwkqq__020"};var ut=e=>{let t=Rr(a);return Gr.createElement("label",{className:`${mt.label} ${t?.forms?.labelClassName}`},e.text)};import Wr,{useContext as Zr}from"react";var dt={input:"FormInput-module__input_x5oyYq__020"};var ct=e=>{let t=Zr(a),o=r=>{e.onChange(r.target.value)};return Wr.createElement("input",{ref:e.ref,className:`${dt.input} ${e.className||void 0} ${t?.forms?.inputClassName||""}`,value:e.value,onChange:o})};import jr,{useContext as Qr}from"react";var pt={error:"FormError-module__error_TZXMUq__020"};var ft=e=>{let t=Qr(a);return jr.createElement("span",{className:`${pt.error} ${t?.forms?.errorClassName||""}`},e.text)};import Yr,{useContext as Jr}from"react";var gt={container:"FormButtonGroup-module__container_4Hygba__020"};var Ct=e=>{let t=Jr(a);return Yr.createElement("div",{className:`${gt.container} ${t?.forms?.buttonsContainerClassName||""}`},e.children)};import Xr,{useContext as en}from"react";var Et={button:"FormButton-module__button_C8cIaW__020"};var ht=e=>{let t=en(a),o=r=>{r.preventDefault()};return Xr.createElement("button",{className:`${Et.button} ${t?.forms?.buttonClassName} ${e.type}`,onClick:e.onClick,onMouseDown:o},e.children)};var m=e=>{let t=on(a);return tn.createElement("form",{className:`${it.container} ${t?.forms?.containerClassName||""}`},e.children)};m.Group=ne;m.Label=ut;m.Input=ct;m.Error=ft;m.ButtonGroup=Ct;m.Button=ht;var yt=()=>{let e=rn(a),t=mn(),[o,r]=bt(!1),[s,d]=bt(""),x=sn(null);nn(()=>{if(!o)return;x.current?.focus();let b=n.nearestElementOfType(t,"hyperlink");if(!b||!b.href)return d("https://niiice.io");d(b.href)},[o,t]);let k=()=>{r(!1),an.focus(t)},T=()=>{r(!o)},P=()=>{H.onUpsert&&(H.onUpsert(t,{href:s,children:[{text:s}]}),k())},C=ln(()=>n.isChildOf(t,"hyperlink"),[t.selection]),c=()=>{H.toggle(t),k()},f=()=>{P()};return I.createElement("div",{className:he.container},I.createElement(v,{onClick:T,icon:"hyperlink"}),o&&I.createElement(re,{onClose:k,onPressEnter:f,align:"top-right"},I.createElement(m,null,I.createElement(m.Group,null,I.createElement(m.Label,{text:e?.texts?.url||"Url"}),I.createElement(m.Input,{ref:x,value:s,onChange:d,className:he.hrefInput})),I.createElement(m.ButtonGroup,null,C&&I.createElement(m.Button,{type:"danger",onClick:c},e?.texts?.remove||"Remove"),I.createElement(m.Button,{type:"primary",onClick:P},e?.texts?.insert||"Insert")))))};import{ReactEditor as un,useSlate as dn}from"slate-react";import S,{useContext as cn,useEffect as pn,useRef as fn,useState as _t}from"react";var be={container:"ImageToolbarButton-module__container_N6H06G__020",srcInput:"ImageToolbarButton-module__srcInput_N6H06G__020"};var vt=e=>{let t=cn(a),o=dn(),[r,s]=_t(!1),[d,x]=_t(""),k=fn(null);pn(()=>{if(!r)return;k.current?.focus();let b=n.nearestElementOfType(o,"image");if(!b||!b.src)return x("https://niiice.io/wp-content/uploads/2020/04/niiice-Logo_dark.png");x(b.src)},[r,o]);let T=()=>{s(!1),un.focus(o)},P=()=>{s(!r)},C=()=>{F.onUpsert&&(F.onUpsert(o,{src:d}),T())},c=()=>{C()},f=()=>{e.onUploadRequest&&(T(),e.onUploadRequest("image/*"))};return S.createElement("div",{className:be.container},S.createElement(v,{onClick:P,icon:"image"}),r&&S.createElement(re,{onClose:T,onPressEnter:c,align:"top-right"},S.createElement(m,null,S.createElement(m.Group,null,S.createElement(m.Label,{text:t?.texts?.url||"Url"}),S.createElement(m.Input,{ref:k,value:d,onChange:x,className:be.srcInput})),S.createElement(m.ButtonGroup,null,e.onUploadRequest&&S.createElement(m.Button,{type:"secondary",onClick:f},t?.texts?.upload||"Upload"),S.createElement(m.Button,{type:"primary",onClick:C},t?.texts?.insert||"Insert")))))};var xt=e=>{let t=Cn(),o=gn(a),r=()=>{L.toggleBold(t)},s=()=>{L.toggleItalic(t)},d=f=>{q[`heading-${f}`].toggle(t,{actor:"toolbar"})},x=()=>{X.toggle(t,{actor:"toolbar"})},k=()=>{ee.toggle(t,{actor:"toolbar"})},T=()=>{O.toggle(t,{actor:"toolbar"})},P=()=>{V.toggle(t,{actor:"toolbar"})},C=()=>{e.onUploadRequest&&e.onUploadRequest(void 0,!0)},c={bold:L.isBoldActive(t),italic:L.isItalicActive(t),"heading-1":W.active(t),"heading-2":Z.active(t),"heading-3":j.active(t),"heading-4":Q.active(t),"heading-5":Y.active(t),"heading-6":J.active(t),"unordered-list":G.active(t),"ordered-list":R.active(t),blockquote:O.active(t),code:V.active(t),hyperlink:H.active(t)};return h.createElement("div",{className:`${ce.container} ${o?.toolbar?.containerClassName||""}`},h.createElement("div",{className:ce.innerContainer},h.createElement(v,{icon:"bold",onClick:r,active:c.bold}),h.createElement(v,{icon:"italic",onClick:s,active:c.italic}),h.createElement(D,null),[1,2,3,4,5,6].map(f=>h.createElement(v,{key:f,onClick:()=>d(f),text:`H${f}`,active:c[`heading-${f}`]})),h.createElement(D,null),h.createElement(v,{icon:"unordered-list",onClick:x,active:c["unordered-list"]}),h.createElement(v,{icon:"ordered-list",onClick:k,active:c["ordered-list"]}),h.createElement(D,null),h.createElement(v,{icon:"blockquote",onClick:T,active:c.blockquote}),h.createElement(v,{icon:"code",onClick:P,active:c.code}),h.createElement(D,null),h.createElement(yt,null),h.createElement(vt,{onUploadRequest:e.onUploadRequest}),e.onUploadRequest&&h.createElement(v,{icon:"upload",onClick:C,active:!1})))};var ye={container:"MarkdownEditor-module__container_mfJZzW__020",editor:"MarkdownEditor-module__editor_mfJZzW__020"};var le={container:"elements-module__container_bH2TYq__020"};import $,{useContext as _n,useEffect as vn,useState as Tt}from"react";var _e={fileInput:"UploadModal-module__fileInput_uGKa2W__020",progressBar:"UploadModal-module__progressBar_uGKa2W__020"};import M,{useContext as En,useRef as hn}from"react";import{IoCloseOutline as bn}from"react-icons/io5";var U={bodyContainer:"Modal-module__bodyContainer_QZ8FHq__020",closeButton:"Modal-module__closeButton_QZ8FHq__020",container:"Modal-module__container_QZ8FHq__020",header:"Modal-module__header_QZ8FHq__020",headerContainer:"Modal-module__headerContainer_QZ8FHq__020",innerContainer:"Modal-module__innerContainer_QZ8FHq__020"};import{useOnClickOutside as yn}from"usehooks-ts";var kt=e=>{let t=En(a),o=hn(null);return yn(o,e.onClose),M.createElement("div",{className:`${U.container} ${t?.modal?.containerClassName||""}`},M.createElement("div",{className:`${U.innerContainer} ${t?.modal?.innerContainerClassName||""}`,ref:o},M.createElement("div",{className:`${U.headerContainer} ${t?.modal?.headerContainerClassName||""}`},M.createElement("span",{className:U.header},e.title),M.createElement("button",{className:U.closeButton,onClick:e.onClose},M.createElement(bn,{size:"1.5rem"}))),M.createElement("div",{className:`${U.bodyContainer} ${t?.modal?.bodyContainerClassName||""}`},e.children)))};var Ht=e=>{let t=_n(a),[o,r]=Tt(null),[s,d]=Tt(null),x=C=>{r(C.message)},k=C=>{d(C)},T=(C,c,f)=>{e.onUploadFinish(C,c,f)};vn(()=>{e.uploader.setOnProgressViewCallback(k),e.uploader.setOnErrorViewCallback(x),e.uploader.setOnFinishViewCallback(T)},[e.uploader]);let P=C=>{r(null);let c=C.currentTarget.files;if(!c)return;let f=Array.from(c);if(e.acceptedFileTypes){for(let b of f)if(!xn(b.type,e.acceptedFileTypes))return r(t?.texts?.invalidFileTypeError||"Invalid file type.")}if(e.maxFileSize){for(let b of f)if(b.size>e.maxFileSize)return r(t?.texts?.maxFileSizeError||"File too large.")}d(0);for(let b of f)e.uploader.startUpload(b).then()};return $.createElement(kt,{title:t?.texts?.uploadModalHeaderTitle||"Upload file",onClose:e.onClose},$.createElement(m,null,$.createElement(ne,null,$.createElement("input",{className:_e.fileInput,type:"file",onChange:P,disabled:s!==null}),o&&$.createElement(m.Error,{text:o}))),s!==null&&$.createElement("progress",{className:_e.progressBar,max:100,value:s*100}))},xn=(e,t)=>(t=t.replace(/\s/g,""),t.split(",").some(r=>{if(r.endsWith("/*")){let s=r.split("/")[0];return e.startsWith(s)}else return r===e}));import Pt from"react";var Nt=e=>Pt.createElement("span",{contentEditable:!1,...e.attributes},Pt.createElement("img",{src:e.element.src,alt:e.element.altText||"Image"}),e.children);import kn from"react";var It=e=>kn.createElement("a",{href:e.element.href,...e.attributes},e.children);import Tn from"react";var St=e=>Tn.createElement(a.Provider,{value:e.value},e.children);import Hn from"react";var Bt=e=>Hn.createElement("li",{...e.attributes},e.children);var Ln=e=>{let[t]=wt(()=>Mn(Un(Fn(In())))),[o,r]=wt({show:!1}),s=Pn([]),d=Ft(i=>{switch(i.element.type){case"blockquote":return u.createElement(Pe,{...i});case"code":return u.createElement(Te,{...i});case"heading-1":return u.createElement(Ne,{...i});case"heading-2":return u.createElement(Ie,{...i});case"heading-3":return u.createElement(Se,{...i});case"heading-4":return u.createElement(Be,{...i});case"heading-5":return u.createElement(Fe,{...i});case"heading-6":return u.createElement(we,{...i});case"image":return u.createElement(Nt,{...i});case"hyperlink":return u.createElement(It,{...i});case"ordered-list-item":return u.createElement(Bt,{...i});case"ordered-list":return u.createElement(Le,{...i});case"unordered-list":return u.createElement(Ue,{...i});case"unordered-list-item":return u.createElement(Me,{...i});default:return u.createElement(He,{...i})}},[]),x=Ft(i=>u.createElement(Ye,{...i}),[]),k=i=>{switch(i.key){case"_":case"*":{L.handleBoldAndItalic(t,i);break}case" ":case"Dead":{let p=n.textSinceBlockStart(t);if(!p)break;let _=!1;for(let w of fe)if(p===w.shortcutText||w.shortcutRegex?.test(p)){n.deleteFromLeft(t,p.length),w.toggle(t,{actor:"shortcut",actorShortcut:p}),i.preventDefault(),_=!0;break}if(_||!t.selection)return;for(let w of oe){if(!w.shortcutRegex)continue;let K=p.match(w.shortcutRegex);if(K){n.deleteAt(t,{path:t.selection.anchor.path,offset:p.length-K[0].length},K[0].length),w.toggle(t,{actor:"shortcut",actorShortcutMatch:K}),i.preventDefault();break}}break}case"Tab":{let p=n.currentBlockType(t);if(!p)break;let _=q[p].onTab;if(!_)break;_(t,i);break}case"Enter":{let p=n.currentElementType(t);if(!p)break;let _=q[p].onEnter;if(!_)break;_(t,i);break}}},T=i=>{if(t.operations.some(_=>_.type!=="set_selection")){if(s.current=i,!e.onChange)return;e.onChange(i)}},P=i=>{e.onBlur&&(e.onBlur(i,s.current),i.preventDefault())},C=(i,p)=>{r({show:!0,accept:i,forceAttachment:p})},c=()=>{r({show:!1}),wn.focus(t)},f=(i,p,_)=>{if(p.type.includes("image")&&!o.forceAttachment){if(!F.onUpsert)return;F.onUpsert(t,{src:i,metaData:_})}else{if(!H.onUpsert)return;H.onUpsert(t,{children:[{text:p.name}],href:i,metaData:_})}c()},b=Nn(()=>e.initialValue&&e.initialValue.length>0?e.initialValue:[{type:"paragraph",children:[{text:e.defaultText!==void 0?e.defaultText:""}]}],[e.initialValue,e.defaultText]);return u.createElement(St,{value:e.customStyle},u.createElement(Sn,{editor:t,value:b,onChange:T},u.createElement("div",{className:`${ye.container} ${e.customStyle?.editor?.containerClassName||""}`},u.createElement(xt,{onUploadRequest:e.uploadInfo?C:void 0}),u.createElement(Bn,{className:`${ye.editor} ${le.container} ${e.customStyle?.editor?.editorContainerClassName||""}`,renderElement:d,renderLeaf:x,onKeyDown:k,onBlur:P})),e.uploadInfo&&o.show&&u.createElement(Ht,{onUploadFinish:f,onClose:c,...e.uploadInfo,acceptedFileTypes:o.accept||e.uploadInfo.acceptedFileTypes})))},Un=e=>{let{isInline:t}=e;return e.isInline=o=>oe.map(s=>s.elementType).includes(o.type)||t(o),e},Mn=e=>{let{isVoid:t}=e;return e.isVoid=o=>ge.map(s=>s.elementType).includes(o.type)||t(o),e};import Vn,{useMemo as Dn}from"react";var Lt=(e,t)=>e.filter(o=>o===t).length,Ut=e=>Array(e*4).join(" "),An={blockquote:(e,t)=>`> ${y(e.children,[...t,"blockquote"])}
`,code:(e,t)=>`\`\`\`
${y(e.children,[...t,"code"])}
\`\`\`
`,"heading-1":(e,t)=>`# ${y(e.children,[...t,"heading-1"])}
`,"heading-2":(e,t)=>`## ${y(e.children,[...t,"heading-2"])}
`,"heading-3":(e,t)=>`### ${y(e.children,[...t,"heading-3"])}
`,"heading-4":(e,t)=>`#### ${y(e.children,[...t,"heading-4"])}
`,"heading-5":(e,t)=>`##### ${y(e.children,[...t,"heading-5"])}
`,"heading-6":(e,t)=>`###### ${y(e.children,[...t,"heading-6"])}
`,hyperlink:(e,t)=>`[${y(e.children,[...t,"hyperlink"])}](${e.href||""})`,image:(e,t)=>`![${e.altText||""}](${e.src||""})`,"ordered-list":(e,t)=>y(e.children,[...t,"ordered-list"]),"ordered-list-item":(e,t)=>{let o=Lt(t,"ordered-list"),r=Ut(o-1);return r=`${r}1. ${y(e.children,[...t,"ordered-list-item"])}
`,r},paragraph:(e,t)=>`
${y(e.children,[...t,"paragraph"])}
`,"unordered-list":(e,t)=>y(e.children,[...t,"unordered-list"]),"unordered-list-item":(e,t)=>{let o=Lt(t,"unordered-list"),r=Ut(o-1);return r=`${r}* ${y(e.children,[...t,"unordered-list-item"])}
`,r}},qn=e=>{if(!e.text)return"";let t=e.text;return e.bold&&(t=`**${t}**`),e.italic&&(t=`*${t}*`),t},$n=(e,t)=>{let o=An[e.type];return o?o(e,t):""},On=(e,t)=>{if(n.isLeaf(e))return qn(e);let o=e;return o.type?$n(o,t):""},y=(e,t,o="")=>e?e?.map(r=>On(r,t)).join(o):"",ve=e=>y(e,[]);import Kn from"react-markdown";import zn from"remark-gfm";import Gn from"remark-breaks";var Rn=e=>{let t=Dn(()=>typeof e.value=="string"?e.value:ve(e.value),[e.value]);return Vn.createElement(Kn,{className:`${le.container} ${e.className||""}`,remarkPlugins:[zn,Gn]},t)};var xe=class{onProgress(t){this.onProgressViewCallback&&this.onProgressViewCallback(t)}onFinish(t,o,r={}){this.onFinishViewCallback&&this.onFinishViewCallback(t,o,r)}onError(t){this.onErrorViewCallback&&this.onErrorViewCallback(t)}setOnProgressViewCallback(t){this.onProgressViewCallback=t}setOnFinishViewCallback(t){this.onFinishViewCallback=t}setOnErrorViewCallback(t){this.onErrorViewCallback=t}};export{xe as AbstractUploader,Ln as MarkdownEditor,Rn as MarkdownView,ve as toMarkdown};
//# sourceMappingURL=index.js.map
