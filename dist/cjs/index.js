"use strict";var Eo=Object.create;var W=Object.defineProperty;var ho=Object.getOwnPropertyDescriptor;var bo=Object.getOwnPropertyNames;var yo=Object.getPrototypeOf,_o=Object.prototype.hasOwnProperty;var vo=(e,t)=>{for(var o in t)W(e,o,{get:t[o],enumerable:!0})},Oe=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of bo(t))!_o.call(e,s)&&s!==o&&W(e,s,{get:()=>t[s],enumerable:!(r=ho(t,s))||r.enumerable});return e};var a=(e,t,o)=>(o=e!=null?Eo(yo(e)):{},Oe(t||!e||!e.__esModule?W(o,"default",{value:e,enumerable:!0}):o,e)),xo=e=>Oe(W({},"__esModule",{value:!0}),e);var mn={};vo(mn,{AbstractUploader:()=>_e,MarkdownEditor:()=>mo,MarkdownView:()=>Co,toMarkdown:()=>be});module.exports=xo(mn);var u=a(require("react")),ao=require("slate"),M=require("slate-react");var ve=a(require("react")),Ve=e=>ve.default.createElement("pre",{...e.attributes},ve.default.createElement("code",null,e.children));var De=a(require("react")),Ke=e=>De.default.createElement("p",{...e.attributes},e.children);var ze=a(require("react")),Ge=e=>ze.default.createElement("blockquote",{...e.attributes},e.children);var Re=a(require("react")),We=e=>Re.default.createElement("h1",{...e.attributes},e.children);var Ze=a(require("react")),je=e=>Ze.default.createElement("h2",{...e.attributes},e.children);var Qe=a(require("react")),Ye=e=>Qe.default.createElement("h3",{...e.attributes},e.children);var Je=a(require("react")),Xe=e=>Je.default.createElement("h4",{...e.attributes},e.children);var et=a(require("react")),tt=e=>et.default.createElement("h5",{...e.attributes},e.children);var ot=a(require("react")),rt=e=>ot.default.createElement("h6",{...e.attributes},e.children);var nt=a(require("react")),lt=e=>nt.default.createElement("ol",{...e.attributes},e.children);var st=a(require("react")),it=e=>st.default.createElement("ul",{...e.attributes},e.children);var at=a(require("react")),mt=e=>at.default.createElement("li",{...e.attributes},e.children);var i=require("slate"),ut=(e,t,o)=>{i.Transforms.setNodes(e,{...o,type:t})},ko=e=>{let t=xe(e);t&&i.Transforms.unwrapNodes(e,{at:t})},xe=e=>e.selection?e.selection.anchor.path.slice(0,-1):null,dt=e=>{let t=e.selection?.anchor.path;return t?(t=t.slice(0,-1),i.Node.get(e,t)):null},To=e=>{if(!e.selection)return null;let t=dt(e);return t?t.type:null},Ho=(e,t)=>{let o=e.selection?.anchor.path;if(!o)return null;do{let r=i.Node.get(e,o);if(!r)return null;if(r.type===t)return r;o=o?.slice(0,-1)}while(o.length>0);return null},ct=e=>{i.Transforms.splitNodes(e,{always:!0})},Po=(e,t,o={})=>{if(i.Transforms.insertNodes(e,{...o.props,type:t,children:o.children||[{text:""}]},{voids:o.voids}),o.createFollowingParagraph&&i.Transforms.insertNodes(e,{type:"paragraph",children:[{text:""}]}),o.createFollowingText!==void 0){if(!e.selection)return;let r=i.Editor.parent(e,e.selection)[1];r[r.length-1]++,i.Transforms.insertNodes(e,{text:o.createFollowingText},{at:r}),i.Transforms.select(e,{anchor:{path:r,offset:o.createFollowingText.length},focus:{path:r,offset:o.createFollowingText.length}})}},No=(e,t,o={})=>{i.Transforms.wrapNodes(e,{type:t,...o},{split:!0})},Io=e=>{i.Transforms.liftNodes(e)},So=e=>{i.Transforms.unwrapNodes(e)},ke=e=>e.selection?i.Point.equals(e.selection.anchor,e.selection.focus):!1,pt=e=>e.selection?!ke(e):!1,Te=e=>{let t=i.Editor.above(e,{match:r=>i.Editor.isBlock(e,r)}),o=t?t[1]:[];return i.Editor.start(e,o)},ft=e=>{let t=i.Editor.above(e,{match:r=>i.Editor.isBlock(e,r)}),o=t?t[1]:[];return i.Editor.end(e,o)},gt=e=>{if(!e.selection)return null;let t=Te(e),o={anchor:e.selection.anchor,focus:t};return i.Editor.string(e,o)},Bo=e=>{if(!e.selection)return null;let t=ft(e),o={anchor:e.selection.focus,focus:t};return i.Editor.string(e,o)},Fo=(e,t,o)=>{if(!e.selection)return null;let r=He(e);if(!r)return null;let s=r.lastIndexOf(t);return o?.isolated&&(r.substring(s+t.length,s+t.length*2)===t||r.substring(s-t.length,s)===t)||s===-1?null:{path:e.selection.anchor.path,offset:s}},wo=(e,t)=>!e.selection||!ke(e)?!1:!!gt(e)?.endsWith(t),He=e=>e.selection?i.Editor.string(e,{anchor:{path:e.selection.anchor.path,offset:0},focus:e.selection.anchor}):null,Ct=(e,t)=>{if(!e.selection)return;let o=Te(e);o&&(i.Transforms.delete(e,{at:{anchor:o,focus:e.selection.anchor}}),i.Transforms.insertText(e,t,{at:o}))},Lo=(e,t)=>{let o=He(e);o&&(o=o.slice(t),Ct(e,o))},Uo=(e,t)=>{for(let o=0;o<t;o++)i.Editor.deleteBackward(e,{unit:"character"})},Mo=(e,t,o)=>{i.Transforms.delete(e,{at:t,distance:o,unit:"character"})},Et=(e,t)=>e.selection?i.Editor.above(e,{match:o=>t.includes(o.type)})!==void 0:!1,Ao=(e,t)=>e.selection?Et(e,[t]):!1,ht=e=>{if(!e.selection)return null;let t=i.Editor.above(e,{match:o=>i.Editor.isBlock(e,o)});return!t||!_t(t[0])?null:t[0]},qo=e=>{if(!e.selection)return null;let t=xe(e);return t?Pe(e,t):null},Pe=(e,t)=>{let o=t;if(o.length===0)return null;do{let r=i.Node.get(e,o);if(!r)return null;if(i.Editor.isBlock(e,r))return o;o=o.slice(0,-1)}while(o.length>0);return null},$o=e=>{if(!e.selection)return null;let t=ht(e);return t?t.type:null},bt=e=>{if(!e.selection)return null;let t=qo(e);return!t||(t=t.slice(0,-1),t=Pe(e,t),!t)?null:i.Node.get(e,t)},Oo=e=>{let t=bt(e);return t?t.type:null},yt=e=>{if(!e.selection)return null;let t=i.Editor.node(e,e.selection.anchor);return!t||!vt(t[0])?null:t[0]},_t=e=>{let t=e;return!!(t&&t.type)},vt=e=>{let t=e;return!!(t&&t.text)},Vo=e=>{let t=e.selection?.anchor||e.selection?.focus;return t?t.path.length<=2:!1},Do=e=>{let t=e,o=e;return!t.text&&!o.type},Ko=e=>{if(pt(e)||!e.selection)return!1;let t=yt(e);return t?t.text==="":!0},zo=e=>{e.selection&&(ct(e),ut(e,"paragraph"),xt(e))},Go=e=>{i.Transforms.insertText(e,`
`)},xt=e=>{for(;!n.isAtRoot(e);)i.Transforms.liftNodes(e)},Ro=(e,t,o)=>{e.selection&&i.Transforms.setNodes(e,t,{at:o||e.selection,match:r=>i.Text.isText(r),split:!0})},Wo=(e,t,o)=>{i.Transforms.setNodes(e,o,{match:r=>r.type===t})},n={removeInlineNode:ko,changeCurrentNodeType:ut,createNewNode:Po,createNewNodeOfCurrentType:ct,wrapNode:No,unwrapNode:Io,unwrapLeaf:So,isCursor:ke,isSelection:pt,nearestBlockPath:Pe,currentBlockStart:Te,currentBlockEnd:ft,textSinceBlockStart:gt,textToBlockEnd:Bo,lastPosOf:Fo,cursorIsBehind:wo,currentBlockText:He,setCurrentBlockText:Ct,deleteFromLeft:Lo,deleteFromRight:Uo,deleteAt:Mo,isChildOf:Ao,isChildOfAny:Et,nearestElementOfType:Ho,currentBlock:ht,currentBlockType:$o,currentElement:dt,currentElementType:To,currentElementPath:xe,parentBlock:bt,parentBlockType:Oo,currentLeaf:yt,isElement:_t,isLeaf:vt,isRoot:Do,isEmpty:Ko,isAtRoot:Vo,createRootParagraph:zo,createNewline:Go,liftToRoot:xt,setLeafFormat:Ro,changeNearestNodeProps:Wo};var Z=a(require("react")),kt=e=>{let t=Z.default.createElement("span",{...e.attributes},e.children);return e.leaf.bold&&(t=Z.default.createElement("strong",null,t)),e.leaf.italic&&(t=Z.default.createElement("em",null,t)),t};var L=require("slate");var Tt=e=>!!L.Editor.marks(e)?.bold,Ht=e=>!!L.Editor.marks(e)?.italic,Pt=(e,t)=>{e.selection&&n.setLeafFormat(e,{bold:!0},t)},Zo=e=>{n.setLeafFormat(e,{bold:void 0})},Nt=(e,t)=>{e.selection&&n.setLeafFormat(e,{italic:!0},t)},jo=e=>{n.setLeafFormat(e,{italic:void 0})},Qo=e=>{Tt(e)?L.Editor.removeMark(e,"bold"):L.Editor.addMark(e,"bold",!0)},Yo=e=>{Ht(e)?L.Editor.removeMark(e,"italic"):L.Editor.addMark(e,"italic",!0)},Jo=(e,t)=>{if(["_","*"].includes(t.key))if(n.cursorIsBehind(e,t.key)){let o=n.lastPosOf(e,`${t.key}${t.key}`);if(!o||!e.selection)return;Pt(e,{anchor:o,focus:e.selection.anchor}),L.Editor.addMark(e,"bold",!1),n.deleteAt(e,o,2),n.deleteFromRight(e,1),n.deleteAt(e,e.selection.anchor,1),t.preventDefault()}else{let o=n.lastPosOf(e,t.key,{isolated:!0});if(!o||!e.selection)return;Nt(e,{anchor:o,focus:e.selection.anchor}),L.Editor.addMark(e,"italic",!1),n.deleteAt(e,o,1),t.preventDefault()}},q={isBoldActive:Tt,isItalicActive:Ht,toggleBold:Qo,toggleItalic:Yo,setBold:Pt,setItalic:Nt,unsetBold:Zo,unsetItalic:jo,handleBoldAndItalic:Jo};var h=a(require("react"));var Ne={container:"Toolbar-module__container_rf3kvG__020",innerContainer:"Toolbar-module__innerContainer_rf3kvG__020"};var x=a(require("react"));var It={button:"ToolbarButton-module__button_U5m4DG__020"};var y=require("react-icons/fa");var St=require("react"),d=(0,St.createContext)(void 0);var P=e=>{let t=(0,x.useContext)(d),o=(0,x.useMemo)(()=>{switch(e.icon){case"bold":return x.default.createElement(y.FaBold,null);case"italic":return x.default.createElement(y.FaItalic,null);case"ordered-list":return x.default.createElement(y.FaListOl,null);case"unordered-list":return x.default.createElement(y.FaList,null);case"blockquote":return x.default.createElement(y.FaQuoteLeft,null);case"code":return x.default.createElement(y.FaCode,null);case"upload":return x.default.createElement(y.FaUpload,null);case"hyperlink":return x.default.createElement(y.FaLink,null);case"image":return x.default.createElement(y.FaImage,null)}},[e.icon]);return x.default.createElement("button",{onMouseDown:s=>{s.preventDefault()},className:`${It.button} ${t?.toolbar?.buttonClassName||""} ${e.active?"active":""}`,onClick:e.onClick},o||e.text)};var Bt=require("slate");var V=(e,t)=>{let[o]=Bt.Editor.nodes(e,{match:r=>r.type===t});return!!o},Xo=(e,t)=>{V(e,t)?n.changeCurrentNodeType(e,"paragraph"):n.changeCurrentNodeType(e,t)},er=(e,t)=>{if(!V(e,t))return n.liftToRoot(e),n.changeCurrentNodeType(e,t);n.changeCurrentNodeType(e,"paragraph")},tr=(e,t,o,r)=>{if(V(e,t))n.removeInlineNode(e);else{let g=r&&n.isCursor(e)?{...o,children:r}:o;n.changeCurrentNodeType(e,t,g)}},or=(e,t)=>{let o=V(e,t),r=n.isChildOf(e,"ordered-list-item"),s=n.isChildOf(e,"unordered-list-item"),g=r||s;if(o&&g)return n.unwrapLeaf(e);if(o&&!g)return n.changeCurrentNodeType(e,"paragraph");n.changeCurrentNodeType(e,t),g&&n.wrapNode(e,r?"ordered-list-item":"unordered-list-item")},Ie=(e,t)=>{t.shiftKey?n.createNewline(e):n.createRootParagraph(e),t.preventDefault()},rr=(e,t)=>{let o=n.isChildOf(e,"ordered-list-item"),r=n.isChildOf(e,"unordered-list-item"),s=o||r;if(!s||t.shiftKey)return Ie(e,t);if(s)return n.createNewNodeOfCurrentType(e),n.changeCurrentNodeType(e,o?"ordered-list-item":"unordered-list-item"),t.preventDefault();Ie(e,t)},Ft=(e,t)=>{do n.unwrapNode(e);while(n.parentBlockType(e)===t);n.changeCurrentNodeType(e,"paragraph")},nr=(e,t,o)=>{let r=t==="ordered-list"?"ordered-list-item":"unordered-list-item";if(V(e,r))return Ft(e,t);n.isChildOf(e,t)||n.wrapNode(e,t),n.changeCurrentNodeType(e,r)},lr=(e,t,o)=>{if(o.shiftKey){n.unwrapNode(e);let r=n.parentBlock(e);(!r||r.type!==t)&&n.changeCurrentNodeType(e,"paragraph")}else{let r=n.parentBlock(e);if(!n.currentBlock(e)||!r)return;n.wrapNode(e,t)}o.preventDefault()},sr=(e,t,o)=>{n.textSinceBlockStart(e)===""&&(Ft(e,t),o.preventDefault())},l={defaultIsActive:V,defaultToggle:Xo,toggleInlineNode:tr,toggleAtRoot:er,toggleWithListAllowed:or,onEnterWithShiftLinebreak:Ie,onEnterWithListAndNewlineAllowed:rr,toggleListItem:nr,onTabListItem:lr,onEnterListItem:sr};var ir=e=>l.defaultIsActive(e,"unordered-list"),ar=e=>{l.defaultToggle(e,"unordered-list")},j={elementType:"unordered-list",isVoid:!1,isInline:!1,active:ir,toggle:ar};var mr=e=>l.defaultIsActive(e,"ordered-list"),ur=e=>{l.defaultToggle(e,"ordered-list")},Q={elementType:"ordered-list",isVoid:!1,isInline:!1,active:mr,toggle:ur};var dr=e=>l.defaultIsActive(e,"blockquote"),cr=e=>{l.toggleWithListAllowed(e,"blockquote")},pr=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},K={elementType:"blockquote",shortcutText:">",isVoid:!1,isInline:!1,active:dr,toggle:cr,onEnter:pr};var fr=e=>l.defaultIsActive(e,"code"),gr=e=>{l.toggleWithListAllowed(e,"code")},Cr=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},z={elementType:"code",shortcutText:"```",isVoid:!1,isInline:!1,active:fr,toggle:gr,onEnter:Cr};var Er=e=>l.defaultIsActive(e,"heading-1"),hr=e=>{l.toggleAtRoot(e,"heading-1")},br=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Y={elementType:"heading-1",shortcutText:"#",isVoid:!1,isInline:!1,active:Er,toggle:hr,onEnter:br};var yr=e=>l.defaultIsActive(e,"heading-2"),_r=e=>{l.toggleAtRoot(e,"heading-2")},vr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},J={elementType:"heading-2",shortcutText:"##",isVoid:!1,isInline:!1,active:yr,toggle:_r,onEnter:vr};var xr=e=>l.defaultIsActive(e,"heading-3"),kr=e=>{l.toggleAtRoot(e,"heading-3")},Tr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},X={elementType:"heading-3",shortcutText:"###",isVoid:!1,isInline:!1,active:xr,toggle:kr,onEnter:Tr};var Hr=e=>l.defaultIsActive(e,"heading-4"),Pr=e=>{l.toggleAtRoot(e,"heading-4")},Nr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},ee={elementType:"heading-4",shortcutText:"####",isVoid:!1,isInline:!1,active:Hr,toggle:Pr,onEnter:Nr};var Ir=e=>l.defaultIsActive(e,"heading-5"),Sr=e=>{l.toggleAtRoot(e,"heading-5")},Br=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},te={elementType:"heading-5",shortcutText:"#####",isVoid:!1,isInline:!1,active:Ir,toggle:Sr,onEnter:Br};var Fr=e=>l.defaultIsActive(e,"heading-6"),wr=e=>{l.toggleAtRoot(e,"heading-6")},Lr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},oe={elementType:"heading-6",shortcutText:"######",isVoid:!1,isInline:!1,active:Fr,toggle:wr,onEnter:Lr};var Ur=e=>l.defaultIsActive(e,"unordered-list-item"),Mr=(e,t)=>{l.toggleListItem(e,"unordered-list",t)},Ar=(e,t)=>{l.onTabListItem(e,"unordered-list",t)},qr=(e,t)=>{l.onEnterListItem(e,"unordered-list",t)},re={elementType:"unordered-list-item",shortcutText:"*",isVoid:!1,isInline:!1,active:Ur,toggle:Mr,onTab:Ar,onEnter:qr};var $r=e=>l.defaultIsActive(e,"paragraph"),Or=e=>{n.changeCurrentNodeType(e,"paragraph")},Vr=(e,t)=>{l.onEnterWithShiftLinebreak(e,t)},wt={elementType:"paragraph",isVoid:!1,isInline:!1,active:$r,toggle:Or,onEnter:Vr};var Dr=e=>l.defaultIsActive(e,"hyperlink"),Kr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],s=t.actorShortcutMatch[2];n.createNewNode(e,"hyperlink",{children:[{text:r}],props:{href:s},createFollowingText:" "})}else l.toggleInlineNode(e,"hyperlink",o,[{text:"Link"}])},zr=(e,t)=>{if(!n.isChildOf(e,"hyperlink"))return n.isSelection(e)?n.wrapNode(e,"hyperlink",t):n.createNewNode(e,"hyperlink",{children:t.children,props:t,voids:!0,createFollowingText:" "});n.changeNearestNodeProps(e,"hyperlink",t)},F={elementType:"hyperlink",shortcutRegex:/\[(.+)]\((.+)\)$/,isVoid:!1,isInline:!0,active:Dr,toggle:Kr,onUpsert:zr};var Gr=e=>l.defaultIsActive(e,"image"),Rr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],s=t.actorShortcutMatch[2];n.createNewNode(e,"image",{props:{src:s,altText:r},createFollowingText:" "})}else l.toggleInlineNode(e,"image",o)},Wr=(e,t)=>{let o=n.currentElement(e);o&&(o.type==="image"?n.changeNearestNodeProps(e,"image",t):n.createNewNode(e,"image",{props:t,voids:!0,createFollowingText:" "}))},U={elementType:"image",shortcutRegex:/!\[(.+)]\((.+)\)$/,isVoid:!0,isInline:!0,active:Gr,toggle:Rr,onUpsert:Wr};var Zr=e=>l.defaultIsActive(e,"ordered-list-item"),jr=(e,t)=>{l.toggleListItem(e,"ordered-list",t)},Qr=(e,t)=>{l.onTabListItem(e,"ordered-list",t)},Yr=(e,t)=>{l.onEnterListItem(e,"ordered-list",t)},ne={elementType:"ordered-list-item",shortcutRegex:/^\d+\.$/,isVoid:!1,isInline:!1,active:Zr,toggle:jr,onTab:Qr,onEnter:Yr};var le=[K,z,Y,J,X,ee,te,oe,U,F,Q,ne,wt,j,re],D={};le.forEach(e=>{D[e.elementType]=e});var Se=le.filter(e=>!e.isInline),Jr={};Se.forEach(e=>{Jr[e.elementType]=e});var se=le.filter(e=>e.isInline),Xr={};se.forEach(e=>{Xr[e.elementType]=e});var Be=le.filter(e=>e.isVoid),en={};Be.forEach(e=>{en[e.elementType]=e});var we=a(require("react"));var Fe={container:"ToolbarButtonSpacer-module__container_kEBEkG__020",spacer:"ToolbarButtonSpacer-module__spacer_kEBEkG__020"};var G=()=>we.default.createElement("div",{className:Fe.container},we.default.createElement("div",{className:Fe.spacer}));var jt=require("slate-react");var p=a(require("react"));var $=a(require("react"));var Le={container:"Popover-module__container_dxsL9W__020",innerContainer:"Popover-module__innerContainer_dxsL9W__020"};var Lt=require("usehooks-ts");var ie=e=>{let t=(0,$.useContext)(d),o=(0,$.useRef)(null);(0,Lt.useOnClickOutside)(o,e.onClose);let r=s=>{e.onPressEnter&&s.key==="Enter"&&e.onPressEnter()};return $.default.createElement("div",{className:`${Le.container} ${t?.popover?.containerClassName||""}`},$.default.createElement("div",{className:`${Le.innerContainer} ${e.align} ${t?.popover?.innerContainerClassName||""}`,ref:o,onKeyDown:r},e.children))};var Ue={container:"HyperlinkToolbarButton-module__container_KZEcDq__020",hrefInput:"HyperlinkToolbarButton-module__hrefInput_KZEcDq__020"};var Ce=require("slate-react");var ge=a(require("react"));var Ut={container:"Form-module__container_R0Llbq__020"};var ae=a(require("react"));var Mt={container:"FormGroup-module__container_t4ESPW__020"};var me=e=>{let t=(0,ae.useContext)(d);return ae.default.createElement("div",{className:`${Mt.container} ${t?.forms?.groupClassName||""}`},e.children)};var ue=a(require("react"));var At={label:"FormLabel-module__label_jkwkqq__020"};var qt=e=>{let t=(0,ue.useContext)(d);return ue.default.createElement("label",{className:`${At.label} ${t?.forms?.labelClassName}`},e.text)};var de=a(require("react"));var $t={input:"FormInput-module__input_x5oyYq__020"};var Ot=e=>{let t=(0,de.useContext)(d),o=r=>{e.onChange(r.target.value)};return de.default.createElement("input",{ref:e.ref,className:`${$t.input} ${e.className||void 0} ${t?.forms?.inputClassName||""}`,value:e.value,onChange:o})};var ce=a(require("react"));var Vt={error:"FormError-module__error_TZXMUq__020"};var Dt=e=>{let t=(0,ce.useContext)(d);return ce.default.createElement("span",{className:`${Vt.error} ${t?.forms?.errorClassName||""}`},e.text)};var pe=a(require("react"));var Kt={container:"FormButtonGroup-module__container_4Hygba__020"};var zt=e=>{let t=(0,pe.useContext)(d);return pe.default.createElement("div",{className:`${Kt.container} ${t?.forms?.buttonsContainerClassName||""}`},e.children)};var fe=a(require("react"));var Gt={button:"FormButton-module__button_C8cIaW__020"};var Rt=e=>{let t=(0,fe.useContext)(d),o=r=>{r.preventDefault()};return fe.default.createElement("button",{className:`${Gt.button} ${t?.forms?.buttonClassName} ${e.type}`,onClick:e.onClick,onMouseDown:o},e.children)};var c=e=>{let t=(0,ge.useContext)(d);return ge.default.createElement("form",{className:`${Ut.container} ${t?.forms?.containerClassName||""}`},e.children)};c.Group=me;c.Label=qt;c.Input=Ot;c.Error=Dt;c.ButtonGroup=zt;c.Button=Rt;var Wt=()=>{let e=(0,p.useContext)(d),t=(0,Ce.useSlate)(),[o,r]=(0,p.useState)(!1),[s,g]=(0,p.useState)(""),N=(0,p.useRef)(null);(0,p.useEffect)(()=>{if(!o)return;N.current?.focus();let v=n.nearestElementOfType(t,"hyperlink");if(!v||!v.href)return g("https://niiice.io");g(v.href)},[o,t]);let I=()=>{r(!1),Ce.ReactEditor.focus(t)},B=()=>{r(!o)},w=()=>{F.onUpsert&&(F.onUpsert(t,{href:s,children:[{text:s}]}),I())},_=(0,p.useMemo)(()=>n.isChildOf(t,"hyperlink"),[t.selection]),C=()=>{F.toggle(t),I()},b=()=>{w()};return p.default.createElement("div",{className:Ue.container},p.default.createElement(P,{onClick:B,icon:"hyperlink"}),o&&p.default.createElement(ie,{onClose:I,onPressEnter:b,align:"top-right"},p.default.createElement(c,null,p.default.createElement(c.Group,null,p.default.createElement(c.Label,{text:e?.texts?.url||"Url"}),p.default.createElement(c.Input,{ref:N,value:s,onChange:g,className:Ue.hrefInput})),p.default.createElement(c.ButtonGroup,null,_&&p.default.createElement(c.Button,{type:"danger",onClick:C},e?.texts?.remove||"Remove"),p.default.createElement(c.Button,{type:"primary",onClick:w},e?.texts?.insert||"Insert")))))};var Ee=require("slate-react"),f=a(require("react"));var Me={container:"ImageToolbarButton-module__container_N6H06G__020",srcInput:"ImageToolbarButton-module__srcInput_N6H06G__020"};var Zt=e=>{let t=(0,f.useContext)(d),o=(0,Ee.useSlate)(),[r,s]=(0,f.useState)(!1),[g,N]=(0,f.useState)(""),I=(0,f.useRef)(null);(0,f.useEffect)(()=>{if(!r)return;I.current?.focus();let v=n.nearestElementOfType(o,"image");if(!v||!v.src)return N("https://niiice.io/wp-content/uploads/2020/04/niiice-Logo_dark.png");N(v.src)},[r,o]);let B=()=>{s(!1),Ee.ReactEditor.focus(o)},w=()=>{s(!r)},_=()=>{U.onUpsert&&(U.onUpsert(o,{src:g}),B())},C=()=>{_()},b=()=>{e.onUploadRequest&&(B(),e.onUploadRequest("image/*"))};return f.default.createElement("div",{className:Me.container},f.default.createElement(P,{onClick:w,icon:"image"}),r&&f.default.createElement(ie,{onClose:B,onPressEnter:C,align:"top-right"},f.default.createElement(c,null,f.default.createElement(c.Group,null,f.default.createElement(c.Label,{text:t?.texts?.url||"Url"}),f.default.createElement(c.Input,{ref:I,value:g,onChange:N,className:Me.srcInput})),f.default.createElement(c.ButtonGroup,null,e.onUploadRequest&&f.default.createElement(c.Button,{type:"secondary",onClick:b},t?.texts?.upload||"Upload"),f.default.createElement(c.Button,{type:"primary",onClick:_},t?.texts?.insert||"Insert")))))};var Qt=e=>{let t=(0,jt.useSlate)(),o=(0,h.useContext)(d),r=()=>{q.toggleBold(t)},s=()=>{q.toggleItalic(t)},g=b=>{D[`heading-${b}`].toggle(t,{actor:"toolbar"})},N=()=>{re.toggle(t,{actor:"toolbar"})},I=()=>{ne.toggle(t,{actor:"toolbar"})},B=()=>{K.toggle(t,{actor:"toolbar"})},w=()=>{z.toggle(t,{actor:"toolbar"})},_=()=>{e.onUploadRequest&&e.onUploadRequest(void 0,!0)},C={bold:q.isBoldActive(t),italic:q.isItalicActive(t),"heading-1":Y.active(t),"heading-2":J.active(t),"heading-3":X.active(t),"heading-4":ee.active(t),"heading-5":te.active(t),"heading-6":oe.active(t),"unordered-list":j.active(t),"ordered-list":Q.active(t),blockquote:K.active(t),code:z.active(t),hyperlink:F.active(t)};return h.default.createElement("div",{className:`${Ne.container} ${o?.toolbar?.containerClassName||""}`},h.default.createElement("div",{className:Ne.innerContainer},h.default.createElement(P,{icon:"bold",onClick:r,active:C.bold}),h.default.createElement(P,{icon:"italic",onClick:s,active:C.italic}),h.default.createElement(G,null),[1,2,3,4,5,6].map(b=>h.default.createElement(P,{key:b,onClick:()=>g(b),text:`H${b}`,active:C[`heading-${b}`]})),h.default.createElement(G,null),h.default.createElement(P,{icon:"unordered-list",onClick:N,active:C["unordered-list"]}),h.default.createElement(P,{icon:"ordered-list",onClick:I,active:C["ordered-list"]}),h.default.createElement(G,null),h.default.createElement(P,{icon:"blockquote",onClick:B,active:C.blockquote}),h.default.createElement(P,{icon:"code",onClick:w,active:C.code}),h.default.createElement(G,null),h.default.createElement(Wt,null),h.default.createElement(Zt,{onUploadRequest:e.onUploadRequest}),e.onUploadRequest&&h.default.createElement(P,{icon:"upload",onClick:_,active:!1})))};var Ae={container:"MarkdownEditor-module__container_mfJZzW__020",editor:"MarkdownEditor-module__editor_mfJZzW__020"};var he={container:"elements-module__container_bH2TYq__020"};var T=a(require("react"));var qe={fileInput:"UploadModal-module__fileInput_uGKa2W__020",progressBar:"UploadModal-module__progressBar_uGKa2W__020"};var S=a(require("react")),Yt=require("react-icons/io5");var O={bodyContainer:"Modal-module__bodyContainer_QZ8FHq__020",closeButton:"Modal-module__closeButton_QZ8FHq__020",container:"Modal-module__container_QZ8FHq__020",header:"Modal-module__header_QZ8FHq__020",headerContainer:"Modal-module__headerContainer_QZ8FHq__020",innerContainer:"Modal-module__innerContainer_QZ8FHq__020"};var Jt=require("usehooks-ts");var Xt=e=>{let t=(0,S.useContext)(d),o=(0,S.useRef)(null);return(0,Jt.useOnClickOutside)(o,e.onClose),S.default.createElement("div",{className:`${O.container} ${t?.modal?.containerClassName||""}`},S.default.createElement("div",{className:`${O.innerContainer} ${t?.modal?.innerContainerClassName||""}`,ref:o},S.default.createElement("div",{className:`${O.headerContainer} ${t?.modal?.headerContainerClassName||""}`},S.default.createElement("span",{className:O.header},e.title),S.default.createElement("button",{className:O.closeButton,onClick:e.onClose},S.default.createElement(Yt.IoCloseOutline,{size:"1.5rem"}))),S.default.createElement("div",{className:`${O.bodyContainer} ${t?.modal?.bodyContainerClassName||""}`},e.children)))};var eo=e=>{let t=(0,T.useContext)(d),[o,r]=(0,T.useState)(null),[s,g]=(0,T.useState)(null),N=_=>{r(_.message)},I=_=>{g(_)},B=(_,C,b)=>{e.onUploadFinish(_,C,b)};(0,T.useEffect)(()=>{e.uploader.setOnProgressViewCallback(I),e.uploader.setOnErrorViewCallback(N),e.uploader.setOnFinishViewCallback(B)},[e.uploader]);let w=_=>{r(null);let C=_.currentTarget.files;if(!C)return;let b=Array.from(C);if(e.acceptedFileTypes){for(let v of b)if(!tn(v.type,e.acceptedFileTypes))return r(t?.texts?.invalidFileTypeError||"Invalid file type.")}if(e.maxFileSize){for(let v of b)if(v.size>e.maxFileSize)return r(t?.texts?.maxFileSizeError||"File too large.")}g(0);for(let v of b)e.uploader.startUpload(v).then()};return T.default.createElement(Xt,{title:t?.texts?.uploadModalHeaderTitle||"Upload file",onClose:e.onClose},T.default.createElement(c,null,T.default.createElement(me,null,T.default.createElement("input",{className:qe.fileInput,type:"file",onChange:w,disabled:s!==null}),o&&T.default.createElement(c.Error,{text:o}))),s!==null&&T.default.createElement("progress",{className:qe.progressBar,max:100,value:s*100}))},tn=(e,t)=>(t=t.replace(/\s/g,""),t.split(",").some(r=>{if(r.endsWith("/*")){let s=r.split("/")[0];return e.startsWith(s)}else return r===e}));var $e=a(require("react")),to=e=>$e.default.createElement("span",{contentEditable:!1,...e.attributes},$e.default.createElement("img",{src:e.element.src,alt:e.element.altText||"Image"}),e.children);var oo=a(require("react")),ro=e=>oo.default.createElement("a",{href:e.element.href,...e.attributes},e.children);var no=a(require("react"));var lo=e=>no.default.createElement(d.Provider,{value:e.value},e.children);var so=a(require("react")),io=e=>so.default.createElement("li",{...e.attributes},e.children);var mo=e=>{let[t]=(0,u.useState)(()=>rn(on((0,M.withReact)((0,ao.createEditor)())))),[o,r]=(0,u.useState)({show:!1}),s=(0,u.useRef)([]),g=(0,u.useCallback)(m=>{switch(m.element.type){case"blockquote":return u.default.createElement(Ge,{...m});case"code":return u.default.createElement(Ve,{...m});case"heading-1":return u.default.createElement(We,{...m});case"heading-2":return u.default.createElement(je,{...m});case"heading-3":return u.default.createElement(Ye,{...m});case"heading-4":return u.default.createElement(Xe,{...m});case"heading-5":return u.default.createElement(tt,{...m});case"heading-6":return u.default.createElement(rt,{...m});case"image":return u.default.createElement(to,{...m});case"hyperlink":return u.default.createElement(ro,{...m});case"ordered-list-item":return u.default.createElement(io,{...m});case"ordered-list":return u.default.createElement(lt,{...m});case"unordered-list":return u.default.createElement(it,{...m});case"unordered-list-item":return u.default.createElement(mt,{...m});default:return u.default.createElement(Ke,{...m})}},[]),N=(0,u.useCallback)(m=>u.default.createElement(kt,{...m}),[]),I=m=>{switch(m.key){case"_":case"*":{q.handleBoldAndItalic(t,m);break}case" ":case"Dead":{let E=n.textSinceBlockStart(t);if(!E)break;let H=!1;for(let A of Se)if(E===A.shortcutText||A.shortcutRegex?.test(E)){n.deleteFromLeft(t,E.length),A.toggle(t,{actor:"shortcut",actorShortcut:E}),m.preventDefault(),H=!0;break}if(H||!t.selection)return;for(let A of se){if(!A.shortcutRegex)continue;let R=E.match(A.shortcutRegex);if(R){n.deleteAt(t,{path:t.selection.anchor.path,offset:E.length-R[0].length},R[0].length),A.toggle(t,{actor:"shortcut",actorShortcutMatch:R}),m.preventDefault();break}}break}case"Tab":{let E=n.currentBlockType(t);if(!E)break;let H=D[E].onTab;if(!H)break;H(t,m);break}case"Enter":{let E=n.currentElementType(t);if(!E)break;let H=D[E].onEnter;if(!H)break;H(t,m);break}}},B=m=>{if(t.operations.some(H=>H.type!=="set_selection")){if(s.current=m,!e.onChange)return;e.onChange(m)}},w=m=>{e.onBlur&&(e.onBlur(m,s.current),m.preventDefault())},_=(m,E)=>{r({show:!0,accept:m,forceAttachment:E})},C=()=>{r({show:!1}),M.ReactEditor.focus(t)},b=(m,E,H)=>{if(E.type.includes("image")&&!o.forceAttachment){if(!U.onUpsert)return;U.onUpsert(t,{src:m,metaData:H})}else{if(!F.onUpsert)return;F.onUpsert(t,{children:[{text:E.name}],href:m,metaData:H})}C()},v=(0,u.useMemo)(()=>e.initialValue&&e.initialValue.length>0?e.initialValue:[{type:"paragraph",children:[{text:e.defaultText!==void 0?e.defaultText:""}]}],[e.initialValue,e.defaultText]);return u.default.createElement(lo,{value:e.customStyle},u.default.createElement(M.Slate,{editor:t,value:v,onChange:B},u.default.createElement("div",{className:`${Ae.container} ${e.customStyle?.editor?.containerClassName||""}`},u.default.createElement(Qt,{onUploadRequest:e.uploadInfo?_:void 0}),u.default.createElement(M.Editable,{className:`${Ae.editor} ${he.container} ${e.customStyle?.editor?.editorContainerClassName||""}`,renderElement:g,renderLeaf:N,onKeyDown:I,onBlur:w})),e.uploadInfo&&o.show&&u.default.createElement(eo,{onUploadFinish:b,onClose:C,...e.uploadInfo,acceptedFileTypes:o.accept||e.uploadInfo.acceptedFileTypes})))},on=e=>{let{isInline:t}=e;return e.isInline=o=>se.map(s=>s.elementType).includes(o.type)||t(o),e},rn=e=>{let{isVoid:t}=e;return e.isVoid=o=>Be.map(s=>s.elementType).includes(o.type)||t(o),e};var ye=a(require("react"));var uo=(e,t)=>e.filter(o=>o===t).length,co=e=>Array(e*4).join(" "),nn={blockquote:(e,t)=>`> ${k(e.children,[...t,"blockquote"])}
`,code:(e,t)=>`\`\`\`
${k(e.children,[...t,"code"])}
\`\`\`
`,"heading-1":(e,t)=>`# ${k(e.children,[...t,"heading-1"])}
`,"heading-2":(e,t)=>`## ${k(e.children,[...t,"heading-2"])}
`,"heading-3":(e,t)=>`### ${k(e.children,[...t,"heading-3"])}
`,"heading-4":(e,t)=>`#### ${k(e.children,[...t,"heading-4"])}
`,"heading-5":(e,t)=>`##### ${k(e.children,[...t,"heading-5"])}
`,"heading-6":(e,t)=>`###### ${k(e.children,[...t,"heading-6"])}
`,hyperlink:(e,t)=>`[${k(e.children,[...t,"hyperlink"])}](${e.href||""})`,image:(e,t)=>`![${e.altText||""}](${e.src||""})`,"ordered-list":(e,t)=>k(e.children,[...t,"ordered-list"]),"ordered-list-item":(e,t)=>{let o=uo(t,"ordered-list"),r=co(o-1);return r=`${r}1. ${k(e.children,[...t,"ordered-list-item"])}
`,r},paragraph:(e,t)=>`
${k(e.children,[...t,"paragraph"])}
`,"unordered-list":(e,t)=>k(e.children,[...t,"unordered-list"]),"unordered-list-item":(e,t)=>{let o=uo(t,"unordered-list"),r=co(o-1);return r=`${r}* ${k(e.children,[...t,"unordered-list-item"])}
`,r}},ln=e=>{if(!e.text)return"";let t=e.text;return e.bold&&(t=`**${t}**`),e.italic&&(t=`*${t}*`),t},sn=(e,t)=>{let o=nn[e.type];return o?o(e,t):""},an=(e,t)=>{if(n.isLeaf(e))return ln(e);let o=e;return o.type?sn(o,t):""},k=(e,t,o="")=>e?e?.map(r=>an(r,t)).join(o):"",be=e=>k(e,[]);var po=a(require("react-markdown")),fo=a(require("remark-gfm")),go=a(require("remark-breaks"));var Co=e=>{let t=(0,ye.useMemo)(()=>typeof e.value=="string"?e.value:be(e.value),[e.value]);return ye.default.createElement(po.default,{className:`${he.container} ${e.className||""}`,remarkPlugins:[fo.default,go.default]},t)};var _e=class{onProgress(t){this.onProgressViewCallback&&this.onProgressViewCallback(t)}onFinish(t,o,r={}){this.onFinishViewCallback&&this.onFinishViewCallback(t,o,r)}onError(t){this.onErrorViewCallback&&this.onErrorViewCallback(t)}setOnProgressViewCallback(t){this.onProgressViewCallback=t}setOnFinishViewCallback(t){this.onFinishViewCallback=t}setOnErrorViewCallback(t){this.onErrorViewCallback=t}};
//# sourceMappingURL=index.js.map
